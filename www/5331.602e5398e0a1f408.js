"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5331],{5331:(F,u,s)=>{s.r(u),s.d(u,{MapPageModule:()=>A});var h=s(177),f=s(9417),a=s(8974),m=s(904),c=s(467),v=s(7762),y=s(3006),l=s(8244),t=s(4438),k=s(995),M=s(8225),b=s(4842);const P=()=>[0,.25,.5,.75];function _(i,d){1&i&&(t.j41(0,"div"),t.nrm(1,"audio",11),t.k0s())}function C(i,d){1&i&&(t.j41(0,"div"),t.nrm(1,"audio",12),t.k0s())}function I(i,d){1&i&&(t.j41(0,"div"),t.nrm(1,"audio",13),t.k0s())}function T(i,d){1&i&&(t.j41(0,"div"),t.nrm(1,"audio",14),t.k0s())}function O(i,d){if(1&i){const e=t.RV6();t.j41(0,"ion-content",15)(1,"div",16),t.EFF(2),t.nI1(3,"translate"),t.j41(4,"ion-label")(5,"ion-button",17),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.getPositionNew())}),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"ion-button",18),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.setOpen(!1))}),t.EFF(9),t.nI1(10,"translate"),t.k0s()()()()}2&i&&(t.R7$(2),t.SpI(" ",t.bMT(3,3,"geomap")," "),t.R7$(4),t.SpI(" ",t.bMT(7,5,"yes")," "),t.R7$(3),t.SpI(" ",t.bMT(10,7,"no")," "))}const j=[{path:"",component:(()=>{class i{constructor(e,n,o,r,p,g,B,E){this.formBuilder=e,this.alertController=n,this.redditService=o,this.router=r,this.modalController=p,this.loadingCtrl=g,this.loadingController=B,this.translateConfigService=E,this.location=!1,this.role="",this.table="public_locations_short",this.table2="locations",this.status="",this.category=2,this.filter="",this.per_page=100,this.order_id="id",this.order_by="desc",this.isModalOpen=!1,this.language=this.translateConfigService.getCurrentLang(),console.log(this.language),this.page=1}ngAfterViewInit(){this.initializeMap(),setTimeout(()=>{this.setOpen(!0)},2e3)}setOpen(e){this.isModalOpen=e}initializeMap(){var e=this;return(0,c.A)(function*(){console.log(e.map),e.map&&(e.map.off(),e.map.remove()),e.latposition=48.8582599,e.lngposition=2.2945006,e.map=l.map("map").setView([e.latposition,e.lngposition],16),l.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e.map),yield e.loadingCtrl.create({message:"Chargement..",spinner:"bubbles"}),e.redditService.getDataAll("public_locations_short").subscribe(o=>{e.posts=o.locations,e.posts.forEach(r=>{}),e.loadPoint()})})()}getPositionNew(){var e=this;return(0,c.A)(function*(){const n=yield e.loadingController.create({message:"Recherche localisation"});n.present(),e.setOpen(!1);const o=yield v.L.getCurrentPosition();console.log("Current position:",o),null!==o.coords.latitude&&(e.latposition=o.coords.latitude,e.lngposition=o.coords.longitude,console.log(e.latposition),console.log(e.lngposition),e.location=!0,setTimeout(()=>{n.dismiss(),l.icon({iconUrl:"./assets/icon/marker-icon.png",iconAnchor:[2,32]}),e.addmarker({lat:e.latposition,lng:e.lngposition})},1e3))})()}leafletMap(){l.icon({iconUrl:"./assets/icon/marker-icon.png",iconAnchor:[60,60]}),this.map=new l.Map("map").setView([this.latposition,this.lngposition],14),l.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{}).addTo(this.map),this.markers=l.layerGroup().addTo(this.map)}loadPoint(){this.posts.forEach(e=>{console.log(e),this.addmarker2(e),console.log("foreatch")})}addmarker(e){console.log(e);var n=l.icon({iconUrl:"./assets/icon/marker-icon.png",iconAnchor:[2,32]});const o=l.marker([e.lat,e.lng],{icon:n});this.map.addLayer(o),this.map.setView([this.latposition,this.lngposition],17)}addmarker2(e){var n=l.icon({iconUrl:"./assets/icon/marker-icon-2.png",iconAnchor:[2,10]});console.log(e);const o=l.marker([e.lat,e.lng],{icon:n});o.bindPopup("<p>"+e.title+'</p><center><ion-button id="popup-button" ><ion-icon name="eye-outline"></ion-icon>  </ion-button>'),this.map.addLayer(o),o.on("click",r=>{const p=document.getElementById("popup-button");p&&p.addEventListener("click",g=>{console.log(g),console.log(e.id),this.idetail=e.id,this.edit(e.id),o.closePopup()})})}edit(e){var n=this;return(0,c.A)(function*(){const o=yield n.modalController.create({component:y.F,componentProps:{paramID:e}});return o.onDidDismiss().then(r=>{null!==r&&(n.modelData=r.data,console.log("Modal Data : "+r.data))}),yield o.present()})()}getdataByid(){var e=this;return(0,c.A)(function*(){console.log("detail event"),e.redditService.getByid(e.table,e.eventid).subscribe(n=>{e.postsevents=n.users,console.log(e.postsevents),e.techs=n.techs,e.appointement=[n.appointement],e.lngevnt=e.techs.lenght})})()}onChangeType(e){this.technicienId=e.target.value}doUpdateAppointement(){var e=this;return(0,c.A)(function*(){var n=JSON.stringify({edited_by:e.technicienId,state:2});yield(yield e.alertController.create({header:"Enregistrement",message:"Voulez-vous vraiment ? ",buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:r=>{}},{text:"Oui",handler:()=>{e.redditService.update(e.table,e.eventid,n).toPromise().then(r=>{setTimeout(()=>{e.getdataByid()},400)})}}]})).present()})()}doFinishedAppointement(){var e=this;return(0,c.A)(function*(){var n=JSON.stringify({state:3});yield(yield e.alertController.create({header:"Enregistrement",message:"Voulez-vous vraiment ? ",buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:r=>{}},{text:"Oui",handler:()=>{e.redditService.update(e.table,e.eventid,n).toPromise().then(r=>{setTimeout(()=>{e.getdataByid()},1e3)})}}]})).present()})()}goList(){this.router.navigateByUrl("/tabs/posts")}presentModal(){var e=this;return(0,c.A)(function*(){yield(yield e.modalController.create({component:"open-modal",breakpoints:[0,.3,.5,.8],initialBreakpoint:.5})).present()})()}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(f.ok),t.rXU(a.hG),t.rXU(k.s),t.rXU(m.Ix),t.rXU(a.W3),t.rXU(a.Xi),t.rXU(a.Xi),t.rXU(M.E))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-map"]],decls:21,vars:11,consts:[["color","secondary"],["slot","start"],["slot","primary"],[4,"ngIf"],["icon-left","","color","success","expand","full","shape","round","tappable","",2,"text-transform","capitalize",3,"click"],["name","locate-outline"],["id","map"],["vertical","bottom","horizontal","end","slot","fixed",1,"btmap"],[3,"click"],["name","list"],["trigger","open-modal","handleBehavior","cycle",3,"isOpen","initialBreakpoint","breakpoints"],["controls","","src","https://api.parisboatclub.blog/audio_fr/00_Intro_FR.mp3"],["controls","","src","https://api.parisboatclub.blog/audio_en/00_Intro_EN.mp3"],["controls","","src","https://api.parisboatclub.blog/audio_it/00_Intro_IT.mp3"],["controls","","src","https://api.parisboatclub.blog/audio_es/00_Intro_ES.mp3"],[1,"ion-padding"],[1,"ion-margin-top",2,"text-align","center"],["icon-left","","color","primary","expand","full","shape","round","tappable","",2,"text-transform","capitalize",3,"click"],["icon-left","","color","light","expand","full","shape","round","tappable","",2,"text-transform","capitalize",3,"click"]],template:function(n,o){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-menu-button"),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"ParisBoatClub "),t.k0s(),t.j41(6,"ion-buttons",2),t.DNE(7,_,2,0,"div",3)(8,C,2,0,"div",3)(9,I,2,0,"div",3)(10,T,2,0,"div",3),t.k0s()()(),t.j41(11,"ion-button",4),t.bIt("click",function(){return o.getPositionNew()}),t.nrm(12,"ion-icon",5),t.EFF(13),t.nI1(14,"translate"),t.k0s(),t.nrm(15,"div",6),t.j41(16,"ion-fab",7)(17,"ion-fab-button",8),t.bIt("click",function(){return o.goList()}),t.nrm(18,"ion-icon",9),t.k0s()(),t.j41(19,"ion-modal",10),t.DNE(20,O,11,9,"ng-template"),t.k0s()),2&n&&(t.R7$(7),t.Y8G("ngIf","fr"==o.language),t.R7$(),t.Y8G("ngIf","en"==o.language),t.R7$(),t.Y8G("ngIf","it"==o.language),t.R7$(),t.Y8G("ngIf","es"==o.language),t.R7$(3),t.SpI(" ",t.bMT(14,8,"myposition")," "),t.R7$(6),t.Y8G("isOpen",o.isModalOpen)("initialBreakpoint",.25)("breakpoints",t.lJ4(10,P)))},dependencies:[h.bT,a.Jm,a.QW,a.W9,a.Q8,a.YW,a.eU,a.iq,a.he,a.MC,a.BC,a.ai,a.Sb,b.D9],styles:["#map[_ngcontent-%COMP%]{height:100vh}.btmap[_ngcontent-%COMP%]{bottom:90px;right:15}audio[_ngcontent-%COMP%]{width:110px;height:50px}audio[_ngcontent-%COMP%]::-webkit-media-controls-volume-slider{display:none!important}audio[_ngcontent-%COMP%]::-webkit-media-controls-timeline-container{display:none!important}audio[_ngcontent-%COMP%]::-webkit-media-controls-time-remaining-display{display:none!important}audio[_ngcontent-%COMP%]::-webkit-media-controls-timeline{display:none!important}audio[_ngcontent-%COMP%]::-webkit-media-controls-panel{padding:0 0 0 1px;justify-content:center}"]})}return i})()}];let x=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.$C({type:i});static#n=this.\u0275inj=t.G2t({imports:[m.iI.forChild(j),m.iI]})}return i})(),A=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.$C({type:i});static#n=this.\u0275inj=t.G2t({imports:[h.MD,f.YN,a.bv,x,b.h]})}return i})()}}]);